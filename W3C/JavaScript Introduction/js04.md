# Module 4: Structuring Data

## 1. 物件實字（Object Literal）

```jsx
const js1 = {
  courseName: 'JavaScript intro',
  weeks: 5,
  madeBy: 'W3Cx',
  author: 'Michel Buffa'
};
js1.author; // "Michel Buffa"
```

- 取值方式：
    - `obj.prop`
    - `obj['prop']`（屬性名含空白、符號、數字開頭或來自變數時）

```jsx
const key = 'title';
const book = { '1stPublication': '1943', title: 'Le Petit Prince' };
book[key];            // 'Le Petit Prince'
book['1stPublication'];
```

---

## 2. 物件 vs 陣列（巢狀取值）

- 陣列也是物件
- 巢狀取值可搭配 **可選鏈結**（`?.`）避免錯誤

```jsx
const book = { author: { givenName: 'Joseph', familyName: 'Heller' } };
book.author.givenName; // 'Joseph'
```

---

## 3. 方法與 `this`

```jsx
const darkVador = {
  race: 'human',
  job: 'villain',
  breathe(){ return '...shhh...'; },
  talk(){ return 'come to the dark side ' + this.breathe(); }
};
darkVador.talk();
```

- `this` 指向呼叫該方法的物件
- 方法間可互調：`this.otherMethod()`
- 物件方法應使用一般函式（避免箭頭函式改變 `this`）

---

## 4. 動態增刪屬性/方法

```jsx
const dv = {};
dv.race = 'human';
dv.talk = function(){ return '...'; };
delete dv.race;
```

---

## 5. 常見語法陷阱

```jsx
let pacman = {};
pacman.color = 'yellow';   
```

- JSON 與 JS 物件不同：JSON 不允許尾逗號、字串必須雙引號

---

## 6. 建構函式（ES5）

```jsx
function Hero(name, side){
  this.name = name;
  this.side = side;
}
Hero.prototype.describeYourself = function(){
  return `I'm ${this.name} and I'm from the ${this.side}.`;
};
```

- 慣例：首字母大寫
- 用 `new` 建立實例
- 方法放 `prototype` 節省記憶體
- 可加守門避免漏用 `new`

---

## 7. ES6 `class`

```jsx
class Hero {
  constructor(name, side){ this.name = name; this.side = side; }
  speak(){ return `My name is ${this.name}, I'm with the ${this.side}.`; }
}
```

- 方法自動掛原型
- 支援 **靜態方法** 與 **getter/setter**

---

## 8. 建立物件方式比較

| 方式 | 範例 | 優點 | 適用情境 |
| --- | --- | --- | --- |
| 物件實字 | `{x:1, y:2}` | 簡單 | 一次性設定、常量 |
| 建構函式/class | `new Hero()` | 可擴充、共享方法 | 需要量產與行為封裝 |
| 工廠函式 | `return {x, y}` | 輕量、易測試 | 單純資料封裝 |

---

## 9. 範例：`class Ball`

```jsx
class Ball {
  constructor(x, y, radius, color, speedX, speedY){
    this.x = x; this.y = y;
    this.radius = radius; this.color = color;
    this.speedX = speedX; this.speedY = speedY;
  }
  draw(ctx){ /* ... */ }
  move(){ this.x += this.speedX; this.y += this.speedY; }
}
Ball.speedMultiplier = 1;
```

---

## 10. `this` 使用注意

- 漏用 `new` → `this` 指向 `window`/`undefined`
- 事件處理中 `this` 指向觸發元素（可用 `e.currentTarget`）
- 箭頭函式不綁定 `this`

---

## 11. 物件工具（速查）

```jsx
Object.keys(obj);
Object.values(obj);
Object.entries(obj);
Object.assign({}, a, b);

```

- 深拷貝可用 `structuredClone()`（現代瀏覽器）

---

## 12. 實作

- 用物件實字建立 `book` 並加入方法
- 建構函式 + `prototype` 實作
- 類別加靜態方法與屬性
- 將功能重構成 `class`
- 工廠函式建立資料物件

---

## 13. 參考資源

- MDN：Objects / `this` / Prototypes / Classes / Object.*
- 專案 Linter（ESLint）與格式化（Prettier）

---

## 14. 總結

- 物件 = 資料 + 行為
- `this` 依呼叫位置決定
- ES5 原型與 ES6 `class` 都能量產物件
- 避免全域耦合、方法共享、型別與行為分離